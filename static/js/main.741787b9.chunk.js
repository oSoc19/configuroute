(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1068:function(e,t,a){},1070:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(69),s=a.n(r),l=(a(474),a(85)),i=a(51),c=a(27),u=a(28),m=a(33),d=a(31),h=a(32),p=a(17),g=a(263),f=a.n(g),y=(a(277),a(1087)),b=a(1088),v=a(457),k=a(1071),C=a(101);var E=function(e){return o.a.createElement(k.a,{icon:!0,labelPosition:"left",className:"landing_page_button",onClick:e.onClick},o.a.createElement(C.a,{name:"left arrow",style:{width:"20%"},size:"large"}),"Create new file")};var _=function(e){return o.a.createElement(k.a,{icon:!0,labelPosition:"right",onClick:e.onClick},o.a.createElement(C.a,{name:"download",style:{width:"20%"},size:"large"}),o.a.createElement("input",{type:"file",className:"import_file_button",multiple:"",style:{display:"none"},accept:".json"})," ","Import file")},O=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).parseConfigurationFile=function(){},a.state={screen:"welcoming",errorMessage:"",configFile:"",file:""},a.triggerImportFile=a.triggerImportFile.bind(Object(p.a)(a)),a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"triggerImportFile",value:function(e){var t=document.getElementsByClassName("import_file_button")[0],a=this.props.ruleTypes;t.click(),t.addEventListener("change",function(n){var o=t.files[0];if(o.type.match(/json.*/)){var r=new FileReader;r.onload=function(t){var n,s=!0;try{null==(n=JSON.parse(r.result))["@context"]&&(s=!1),Object.keys(a).map(function(e){return null!=n[e]&&Array.isArray(n[e])||(s=!1),!0})}catch(l){s=!1}s?e.props.onChangeContent("UPLOAD",{valid:!0,file:o,configFile:JSON.parse(r.result)}):e.props.onChangeContent("UPLOAD",{valid:!1,file:null,configFile:null})},r.readAsText(o)}else e.props.onChangeContent("UPLOAD",{valid:!1,file:null,configFile:null})})}},{key:"render",value:function(){var e=this;return o.a.createElement(y.a,{centered:!0},o.a.createElement(y.a.Row,{columns:1,stretched:!0,style:{height:"80%",padding:"0"}},o.a.createElement(y.a.Column,{className:"contentColumn"},o.a.createElement("div",null,o.a.createElement(b.a,{as:"h2",icon:!0,textAlign:"center"},o.a.createElement(v.a,{centered:!0,rounded:!0,src:"assets/logo.jpg",className:"centerLogo"}),o.a.createElement(b.a.Content,null,"Your go-to for creating robust route configurations")),o.a.createElement(b.a,{as:"h3",dividing:!0,textAlign:"center"},"Purpose"),o.a.createElement("p",null,"Ever traveled with unconventional means of transport such as a scooter ? You want to reach specific locations but your route planner takes you through uncomfortable routes? We believe your journey should always be adapted to your very specific mobility needs. For this reason, we created *ConfiguRoute* : a tool to quickly and easily create finely tuned configuration files for your transport profiles.")))),o.a.createElement(y.a.Row,{columns:2,stretched:!0,style:{height:"20%",padding:"0"}},o.a.createElement(k.a.Group,{style:{width:"100%"}},o.a.createElement(E,{onClick:function(){e.props.onChangeContent("NEW")}}),o.a.createElement(k.a.Or,null),o.a.createElement(_,{onClick:function(){e.triggerImportFile(e)}}))))}}]),t}(o.a.Component),S=a(1089),w=a(147);var j=function(e){return o.a.createElement(k.a,{icon:!0,labelPosition:"left",className:"landing_page_button",onClick:e.onClick,style:{padding:0,margin:0,"border-radius":"0 0 0 12px"}},o.a.createElement(C.a,{name:"left arrow",style:{width:"20%"},size:"large"}),"Go back")};var M=function(e){return o.a.createElement(k.a,{icon:!0,labelPosition:"right",className:"landing_page_button",onClick:e.onClick,disabled:e.disabled,style:{padding:0,margin:0,"border-radius":"0px 0px 12px 0px"}},o.a.createElement(C.a,{name:"check",style:{width:"20%"},size:"large"}),e.label?e.label:"Confirm selection")},R=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).validFileScreen=a.validFileScreen.bind(Object(p.a)(a)),a.errorScreen=a.errorScreen.bind(Object(p.a)(a)),a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"computeNumberOfRules",value:function(){var e=this,t=0;return void 0===this.props.data.configFile?t:(Object.keys(this.props.ruleTypes).map(function(a){return t+=e.props.data.configFile[a].length}),t)}},{key:"validFileScreen",value:function(){return o.a.createElement("div",null,o.a.createElement(b.a,null," ",this.props.data.file.name," "),o.a.createElement(S.a,null,o.a.createElement(w.a,null," Size: ")," ",this.props.data.file.size+" bytes"),o.a.createElement(S.a,null," ",o.a.createElement(w.a,null," Label: ")," ",this.props.data.configFile["rdfs:label"]," "),o.a.createElement(S.a,null," ",o.a.createElement(w.a,null," Number of rules: ")," ",this.computeNumberOfRules()))}},{key:"errorScreen",value:function(){return o.a.createElement(b.a,null," ",o.a.createElement(b.a.Content,null," Format unsupported "))}},{key:"content",value:function(){return this.props.data.valid?o.a.createElement(this.validFileScreen,null):o.a.createElement(this.errorScreen,null)}},{key:"render",value:function(){var e=this;return o.a.createElement(y.a,{centered:!0},o.a.createElement(y.a.Row,{columns:1,stretched:!0,style:{height:"80%",padding:"0"}},o.a.createElement(y.a.Column,{className:"contentColumn"},this.content())),o.a.createElement(y.a.Row,{columns:2,stretched:!0,style:{height:"20%",padding:"0"}},o.a.createElement(k.a.Group,{style:{width:"100%"}},o.a.createElement(j,{onClick:function(){e.props.onChangeContent("INDEX")}}),o.a.createElement(k.a.Or,null),o.a.createElement(M,{onClick:function(){e.props.onConfirm(e.props.data.configFile)},disabled:!this.props.data.valid}))))}}]),t}(o.a.Component),F=a(1081),L={"@context":{osm:"https://w3id.org/openstreetmap/terms#",opp:"https://w3id.org/openplannerteam/profile#",prov:"http://www.w3.org/ns/prov#",hasMaxSpeed:{"@id":"opp:hasMaxSpeed"},usePublicTransport:{"@id":"opp:usePublicTransport"},hasAccessRules:{"@id":"opp:hasAccessRules"},hasOnewayRules:{"@id":"opp:hasOnewayRules"},hasSpeedRules:{"@id":"opp:hasSpeedRules"},hasPriorityRules:{"@id":"opp:hasPriorityRules"},hasObstacleRules:{"@id":"opp:hasObstacleRules"},hasAccess:{"@id":"opp:hasAccess"},isOneway:{"@id":"opp:isOneway"},isReversed:{"@id":"opp:isReversed"},hasSpeed:{"@id":"opp:hasSpeed"},isObstacle:{"@id":"opp:isObstacle"},hasPriority:{"@id":"opp:hasPriority"},concludes:{"@id":"opp:concludes"},hasOrder:{"@id":"opp:hasOrder"},match:{"@id":"opp:match"},fromProperty:{"@id":"opp:fromProperty","@type":"@id"},hasPredicate:{"@id":"opp:hasPredicate","@type":"@id"},hasObject:{"@id":"opp:hasObject","@type":"@id"}}},T=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).onNewConfigFileCreation=function(e){var t=a.props.ruleTypes,n=L;return n["rdfs:label"]=e.description,n.hasMaxSpeed=Number(e.maxSpeed),n.usePublicTransport=e.usePublicTransport,Object.keys(a.props.ruleTypes).map(function(e){n[e]=[];var a={concludes:{}};return a.concludes[t[e].conclusion]=t[e].defaultValue,n[e].push(a),e}),n},a.handleChange=function(e,t){var n=t.name,o=t.value;return a.setState(Object(l.a)({},n,o))},a.state={description:"",maxSpeed:"",usePublicTransport:!1,showErrorMessage:!1},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"form",value:function(){var e=this,t=this.state,a=t.description,n=t.maxSpeed,r=t.usePublicTransport;return o.a.createElement(F.a,null,o.a.createElement(F.a.Input,{label:"Description",placeholder:"Vehicle profile for...",name:"description",value:a,onChange:this.handleChange,required:!0}),o.a.createElement(F.a.Input,{type:"number",label:"Maximum speed",placeholder:"Speed in km/h",name:"maxSpeed",value:n,onChange:this.handleChange,required:!0}),o.a.createElement(F.a.Checkbox,{label:"Use public transport",onChange:function(){e.setState({usePublicTransport:!r})},checked:r}),this.state.showErrorMessage&&o.a.createElement(S.a,null," All field values must be completed"))}},{key:"render",value:function(){var e=this;return o.a.createElement(y.a,{centered:!0},o.a.createElement(y.a.Row,{columns:1,stretched:!0,style:{height:"80%",padding:"0"}},o.a.createElement(y.a.Column,{className:"contentColumn"},this.form()," ")),o.a.createElement(y.a.Row,{columns:2,stretched:!0,style:{height:"20%",padding:"0"}},o.a.createElement(k.a.Group,{style:{width:"100%"}},o.a.createElement(j,{onClick:function(){e.props.onChangeContent("INDEX")}}),o.a.createElement(k.a.Or,null),o.a.createElement(M,{disabled:!1,onClick:function(){var t=!1;Object.keys(e.state).map(function(a){return""!==e.state[a]&&null!==e.state[a]||(t=!0),a}),t?e.setState({showErrorMessage:!0}):e.props.onConfirm(e.onNewConfigFileCreation(e.state))}}))))}}]),t}(o.a.Component),P={content:{width:"80%",height:"80%",padding:"0",borderRadius:"12px",outline:"none",border:"none",top:"50%",left:"50%",position:"absolute",marginRight:"-50%",transform:"translate(-50%, -50%)"},overlay:{backgroundColor:"rgba(0, 0, 0, 0.7)"}};f.a.setAppElement("#root");var x=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).content=function(){switch(a.state.content){case"INDEX":return o.a.createElement(O,{ruleTypes:a.props.ruleTypes,onChangeContent:a.handleChangeContent});case"UPLOAD":return o.a.createElement(R,{ruleTypes:a.props.ruleTypes,onChangeContent:a.handleChangeContent,onConfirm:a.handleConfirm,data:a.state.fileData});case"NEW":return o.a.createElement(T,{ruleTypes:a.props.ruleTypes,onChangeContent:a.handleChangeContent,onConfirm:a.handleConfirm});default:return null}},a.state={showModal:!0,content:"INDEX",fileData:{}},a.handleOpenModal=a.handleOpenModal.bind(Object(p.a)(a)),a.handleCloseModal=a.handleCloseModal.bind(Object(p.a)(a)),a.handleChangeContent=a.handleChangeContent.bind(Object(p.a)(a)),a.handleConfirm=a.handleConfirm.bind(Object(p.a)(a)),a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"handleOpenModal",value:function(){this.setState({showModal:!0})}},{key:"handleCloseModal",value:function(){this.setState({showModal:!1})}},{key:"handleChangeContent",value:function(e,t){this.setState({content:e,fileData:t})}},{key:"handleConfirm",value:function(e){this.handleCloseModal(),this.props.onConfirm(e)}},{key:"render",value:function(){return o.a.createElement(f.a,{isOpen:this.state.showModal,contentLabel:"Landing Page",style:P},o.a.createElement(this.content,null))}}]),t}(o.a.Component),A=a(1082),D=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).handleChange=function(e,t){var n=t.name,o=t.value;a.setState(Object(l.a)({},n,o))},a.handleChangeChecked=function(e){return a.setState({conclusion:!a.state.conclusion})},a.content=function(){return o.a.createElement(y.a,{centered:!0,style:{height:"100%",margin:0}},o.a.createElement(y.a.Row,{columns:1,stretched:!0,style:{height:"50%",padding:"12px"}},o.a.createElement(y.a.Column,{className:"contentColumn"},a.form()," ")),o.a.createElement(y.a.Row,{columns:2,stretched:!0,style:{height:"50px",padding:"0"}},o.a.createElement(k.a.Group,{style:{width:"100%"}},o.a.createElement(j,{onClick:a.props.onClose}),o.a.createElement(k.a.Or,null),o.a.createElement(M,{onClick:function(){var e=!1;Object.keys(a.state).map(function(t){return""!==a.state[t]&&null!==a.state[t]||(e=!0),t}),e?a.setState({showErrorMessage:!0}):a.props.onSubmit(a.state)}}))))},a.state={showModal:!0,ruleType:"hasAccessRules",key:"osm:access",value:"osm:Customers",conclusion:!0,order:1},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"form",value:function(){var e,t=Object.keys(this.props.ruleTypes).map(function(e){return{key:e,value:e,text:e}}),a=Object.keys(this.props.selectOptions).map(function(e){return{key:e,value:e,text:e}}),n=this.props.selectOptions[this.state.key],r=void 0===n?[]:n.map(function(e){return{key:e,value:e,text:e}});if("number"===this.props.ruleTypes[this.state.ruleType].type)e=o.a.createElement(F.a.Input,{type:"number",name:"conclusion",placeholder:this.props.ruleTypes[this.state.ruleType].conclusion,label:"conclusion",onChange:this.handleChange,value:this.state.conclusion});else if(""!==this.state.ruleType){var s=this.props.ruleTypes[this.state.ruleType].conclusion;e=o.a.createElement(F.a.Checkbox,{name:"conclusion",placeholder:s,label:s,onChange:this.handleChangeChecked,checked:this.state.conclusion,slider:!0})}else e=null;return o.a.createElement(F.a,null,o.a.createElement(F.a.Select,{name:"ruleType",placeholder:"Type of rule",label:"Rule",options:t,onChange:this.handleChange,value:this.state.ruleType}),o.a.createElement(F.a.Group,null,o.a.createElement(F.a.Select,{name:"key",placeholder:"Condition key",label:"key",options:a,onChange:this.handleChange,value:this.state.key}),o.a.createElement(F.a.Select,{name:"value",placeholder:"Condition value",label:"value",options:r,onChange:this.handleChange,value:this.state.value})),o.a.createElement(F.a.Group,null),e,o.a.createElement(F.a.Input,{name:"order",placeholder:"Order of priority",label:"Order of priority",onChange:this.handleChange,value:this.state.order}),this.state.showErrorMessage&&o.a.createElement(S.a,null," ",o.a.createElement(w.a,null," All field values must be completed ")))}},{key:"render",value:function(){return o.a.createElement(A.a,{open:this.props.showModal,style:{"border-radius":"12px"}},o.a.createElement(this.content,null))}}]),t}(o.a.Component),N=a(1085),I=a(1086),G=a(1079),B=a(1078),U=a(1084),z=a(458),J=a(452),V=a.n(J);function W(e){return o.a.createElement(A.a,{open:e.open,style:{width:"60vw"}},o.a.createElement(z.a,{id:"configFile_editor",placeholder:e.configFile,locale:V.a,height:"70vh",width:"60vw",viewOnly:!0}),o.a.createElement(k.a.Group,{style:{width:"60vw"}},o.a.createElement(j,{onClick:e.onClose})))}var q=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).handleChange=function(e,t){var n=t.value,o=t.checked;void 0===n?a.props.onChange(a.props.type,a.props.index,o):a.props.onChange(a.props.type,a.props.index,n)},a.handleCloseModal=function(){a.setState({showModal:!1})},a.handleOpenModal=function(){a.setState({showModal:!0})},a.state={showModal:!1},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"content",value:function(){var e,t=Object.keys(this.props.rule.concludes)[0];switch(typeof this.props.rule.concludes[t]){case"string":case"number":e=o.a.createElement(G.a,{type:"number",value:this.props.rule.concludes[t],onChange:this.handleChange});break;case"boolean":e=o.a.createElement(B.a,{toggle:!0,checked:this.props.rule.concludes[t],onChange:this.handleChange});break;default:e=null}return 0,o.a.createElement(S.a,null," ",t," ",e," ")}},{key:"render",value:function(){var e,t=this;return e=this.props.rule.match?this.props.rule.match.hasPredicate+" - "+this.props.rule.match.hasObject:"Default rule",o.a.createElement(U.a,{fluid:!0},o.a.createElement(U.a.Content,null," ",o.a.createElement(U.a.Header,null," ",e," ")),o.a.createElement(U.a.Content,null,this.content()),o.a.createElement(U.a.Content,null," ",o.a.createElement(k.a.Group,{style:{width:"100%"}},o.a.createElement(k.a,{onClick:function(){t.props.onDelete(t.props.type,t.props.index)},icon:!0,disabled:"Default rule"===e},o.a.createElement(C.a,{name:"trash alternate outline"})),o.a.createElement(k.a.Or,null),o.a.createElement(k.a,{onClick:function(){t.handleOpenModal()},icon:!0},o.a.createElement(C.a,{name:"code"})))," ",this.state.showModal&&o.a.createElement(W,{open:this.state.showModal,onClose:function(){t.setState({showModal:!1})},configFile:this.props.rule})))}}]),t}(o.a.Component),H=(a(335),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).handleCloseModal=function(){a.setState({showModal:!1})},a.handleClick=function(e,t){var n=t.index,o=a.state.activeIndex===n?-1:n;a.setState({activeIndex:o})},a.handleSubmit=function(e){var t=Object.keys(a.props.ruleTypes).indexOf(e.ruleType);t!=a.state.activeIndex&&a.setState({activeIndex:t}),a.handleCloseModal(),a.props.onNewRuleSubmit(e)},a.displayBasicProperties=function(){return o.a.createElement(o.a.Fragment,{key:10},o.a.createElement(N.a.Title,{active:10===a.state.activeIndex,index:10,onClick:a.handleClick},o.a.createElement(C.a,{name:"dropdown"}),"Basic properties"),o.a.createElement(N.a.Content,{active:10===a.state.activeIndex},Object.keys(a.props.configFile).map(function(e){var t=a.props.configFile[e];if(!Array.isArray(t)&&"object"!==typeof t){var n=e+" : "+t;return o.a.createElement(S.a,{key:n}," ",n," ")}})))},a.state={showModal:!1,showConfigFile:!1,activeIndex:0},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"displayContent",value:function(){var e=this;if(this.props.loaded){var t=-1;return Object.keys(this.props.ruleTypes).map(function(a){t++;var n=0;return o.a.createElement(o.a.Fragment,{key:t},o.a.createElement(N.a.Title,{active:e.state.activeIndex===t,index:t,onClick:e.handleClick},o.a.createElement(C.a,{name:"dropdown"}),a),o.a.createElement(N.a.Content,{active:e.state.activeIndex===t},e.props.configFile[a].map(function(t){return o.a.createElement(q,{type:a,index:n++,key:JSON.stringify(t),rule:t,onChange:e.props.onRuleConclusionChange,onDelete:e.props.onRuleDelete})})))})}return null}},{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"Left-panel"},o.a.createElement(I.a,{style:{margin:"12px",width:"100%"}},o.a.createElement(I.a.Item,null,o.a.createElement(k.a,{primary:!0,onClick:function(){e.setState({showModal:!0})}},"Add a rule")),o.a.createElement(I.a.Item,null,o.a.createElement(k.a,{onClick:function(){e.setState({showConfigFile:!0})},secondary:!0},"Display config file"))),o.a.createElement(N.a,{fluid:!0,styled:!0,style:{margin:"12px"}},this.displayBasicProperties(),this.displayContent()),this.state.showModal&&o.a.createElement(D,{showModal:this.state.showModal,ruleTypes:this.props.ruleTypes,selectOptions:this.props.rulesSelectOptions,onSubmit:this.handleSubmit,onClose:this.handleCloseModal}),this.state.showConfigFile&&o.a.createElement(W,{open:this.state.showConfigFile,configFile:this.props.configFile,onClose:function(){e.setState({showConfigFile:!1})}}))}}]),t}(o.a.Component)),Y=a(197),X=a(454),Q=a(119),Z=a(1080),$=a(1083);function K(e){return o.a.createElement(k.a,{disabled:e.disabled,as:"div",labelPosition:"right",onClick:e.onClick},o.a.createElement(k.a,{icon:!0},o.a.createElement(C.a,{name:"pin icon"}),e.children),o.a.createElement(w.a,{as:"a",basic:!0,pointing:"left"},e.marker.placed&&Math.round(1e4*e.marker.lngLat.lat)/1e4+", "+Math.round(1e4*e.marker.lngLat.lng)/1e4))}var ee=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).state={active_route_label_input:void 0},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"updateActiveRouteText",value:function(e){this.setState({active_route_label_input:e.target.value})}},{key:"render",value:function(){var e=this,t=this.props,a=t.calculating,n=t.from_marker,r=t.to_marker,s=t.selectable_routes,l=t.selected_routes,i=t.handleSelectedRouteAddition,c=t.handleSelectedRoutesChange,u=t.calculateRoute,m=t.saveCurrentRoute,d=t.createToMarker,h=t.createFromMarker;return o.a.createElement(Z.a,{className:"mapToolbar"},o.a.createElement(K,{disabled:a,onClick:function(){h()},marker:n},"From"),o.a.createElement(K,{disabled:a,onClick:function(){d()},marker:r},"To"),o.a.createElement(k.a,{disabled:!(n.lngLat&&r.lngLat)||a,loading:a,onClick:function(){u()}},"Calculate route"),o.a.createElement(G.a,{type:"text",placeholder:"name",onChange:this.updateActiveRouteText,value:this.state.active_route_label_input,action:!0,disabled:!(n.lngLat&&r.lngLat)||a},o.a.createElement("input",null),o.a.createElement(k.a,{type:"submit",onClick:function(){m(e.state.active_route_label_input)},disabled:!(n.lngLat&&r.lngLat)||a},"Save route")),o.a.createElement($.a,{options:s,placeholder:"Choose routes to display",search:!0,selection:!0,fluid:!0,multiple:!0,allowAdditions:!0,value:l,onAddItem:i,onChange:c,className:"routeSelectDropdown"}))}}]),t}(o.a.Component),te=Object(Q.c)({accessToken:"pk.eyJ1Ijoid291dGVydmRkIiwiYSI6ImNqczRvbzRlMzA2a2UzeWx4MHlqem1lajYifQ.-kYtzbZnQhJTVeh8zDfgYg"}),ae={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[0,0]}}]},ne={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[0,0]}}]},oe={"line-cap":"round","line-join":"round"},re={"line-color":"#B52700","line-width":8},se={"line-color":"#BABABA","line-width":5},le={height:"80vh",width:"100%",cursor:""},ie=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).handleSelectedRouteAddition=function(e,t){var n=t.value;console.log("hadleAddition value"),console.log(n),a.setState(function(e){return{selectable_routes:[].concat(Object(Y.a)(e.selectable_routes),[{key:n,text:n,value:n}])}})},a.handleSelectedRoutesChange=function(e,t){var n=t.value;console.log("hadleChange value"),console.log(n),console.log(a.state.saved_routes),a.setState({selected_routes:n})},a.state={center:[4.5118,50.6282],zoom:[6.83],calculating:!1,from_marker:{placed:!1,enabled:!1,dragging:!1,lngLat:void 0},to_marker:{placed:!1,enabled:!1,dragging:!1,lngLat:void 0},active_route:{key:void 0,text:void 0,coordinates:[]},saved_routes:[],selectable_routes:[],selected_routes:[],container_style:le},a.createFromMarker=a.createFromMarker.bind(Object(p.a)(a)),a.createToMarker=a.createToMarker.bind(Object(p.a)(a)),a.onStyleLoad=a.onStyleLoad.bind(Object(p.a)(a)),a.onMouseMove=a.onMouseMove.bind(Object(p.a)(a)),a.onMouseClick=a.onMouseClick.bind(Object(p.a)(a)),a.calculateRoute=a.calculateRoute.bind(Object(p.a)(a)),a.handleSelectedRoutesChange=a.handleSelectedRoutesChange.bind(Object(p.a)(a)),a.handleSelectedRouteAddition=a.handleSelectedRouteAddition.bind(Object(p.a)(a)),a.onMouseUp=a.onMouseUp.bind(Object(p.a)(a)),a.planner=new X.Planner,a.planner.setProfileID("PEDESTRIAN"),a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"componentDidUpdate",value:function(e){e.configFile!==this.props.configFile&&(this.planner.setDevelopmentProfile(this.props.configFile),console.log("config file loaded:"),console.log(this.props.configFile))}},{key:"calculateRoute",value:function(){var e=this;if(this.state.from_marker.placed&&this.state.to_marker.placed&&!this.state.calculating){this.setState({calculating:!0});var t={roadNetworkOnly:!0,from:{latitude:this.state.from_marker.lngLat.lat,longitude:this.state.from_marker.lngLat.lng},to:{latitude:this.state.to_marker.lngLat.lat,longitude:this.state.to_marker.lngLat.lng}};console.log(t),console.log("waiting..."),console.log("querying planner.js..."),this.planner.query(t).take(1).on("error",function(e){console.log(e)}).on("data",function(t){var a=[];t.steps.forEach(function(e){a.push([e.startLocation.longitude,e.startLocation.latitude]),a.push([e.stopLocation.longitude,e.stopLocation.latitude])});var n=new Date;e.setState(function(e){return{active_route:{key:e.saved_routes.length,text:n.toISOString(),coordinates:a}}})}).on("end",function(){console.log("end\n"),e.setState({calculating:!1})})}}},{key:"saveCurrentRoute",value:function(e){this.setState(function(t){return{active_route:{key:t.active_route.key,text:e,coordinates:t.active_route.coordinates}}});var t=this.state.active_route.key,a=!1;this.state.saved_routes.forEach(function(e){e.key!==t||(a=!0)}),a||this.setState(function(e){return{saved_routes:[e.active_route].concat(Object(Y.a)(e.saved_routes)),selectable_routes:[{key:e.active_route.key,text:e.active_route.text,value:e.active_route.key}].concat(Object(Y.a)(e.selectable_routes))}}),console.log(this.state.saved_routes)}},{key:"onMouseUp",value:function(e,t){var a=t.lngLat;this.state.from_marker.dragging?(this.setState(function(e){return{from_marker:{placed:e.from_marker.placed,enabled:e.from_marker.enabled,dragging:!1,lngLat:a}}}),this.calculateRoute()):this.state.to_marker.dragging&&(this.setState(function(e){return{to_marker:{placed:e.to_marker.placed,enabled:e.to_marker.enabled,dragging:!1,lngLat:a}}}),this.calculateRoute())}},{key:"onStyleLoad",value:function(e,t){e.addSource("from_marker",{type:"geojson",data:ae}),e.addSource("to_marker",{type:"geojson",data:ne}),e.addLayer({id:"from_marker",type:"circle",source:"from_marker",paint:{"circle-radius":10,"circle-color":"#3887be"}}),e.addLayer({id:"to_marker",type:"circle",source:"to_marker",paint:{"circle-radius":10,"circle-color":"#6b7cff"}});var a=this;e.on("mouseenter","from_marker",function(){e.setPaintProperty("from_marker","circle-color","#3bb2d0"),le.cursor="move",a.setState({container_style:le})}),e.on("mouseleave","from_marker",function(){e.setPaintProperty("from_marker","circle-color","#3887be"),le.cursor="",a.setState({container_style:le})}),e.on("mousedown","from_marker",function(e){e.preventDefault(),a.setState(function(e){return{from_marker:{placed:e.from_marker.placed,enabled:e.from_marker.enabled,dragging:!0,lngLat:e.from_marker.lngLat}}}),le.cursor="grab",a.setState({container_style:le})}),e.on("mouseenter","to_marker",function(){e.setPaintProperty("to_marker","circle-color","#3bb2d0"),le.cursor="move",a.setState({container_style:le})}),e.on("mouseleave","to_marker",function(){e.setPaintProperty("to_marker","circle-color","#9f7feb"),le.cursor="",a.setState({container_style:le})}),e.on("mousedown","to_marker",function(e){e.preventDefault(),a.setState(function(e){return{to_marker:{placed:e.to_marker.placed,enabled:e.to_marker.enabled,dragging:!0,lngLat:e.to_marker.lngLat}}}),le.cursor="grab",a.setState({container_style:le})})}},{key:"onMouseClick",value:function(e,t){var a=t.lngLat;!this.state.from_marker.enabled||this.state.from_marker.placed||this.state.from_marker.dragging||(console.log("placed from-marker at "+this.state.from_marker.lngLat),this.setState(function(e){return{from_marker:{placed:!0,enabled:!0,dragging:!1,lngLat:a}}}),console.log(this.state.from_marker)),!this.state.to_marker.enabled||this.state.to_marker.placed||this.state.to_marker.dragging||(console.log("placed to-marker at "+this.state.to_marker.lngLat),this.setState(function(e){return{to_marker:{placed:!0,enabled:!0,dragging:!1,lngLat:a}}}),console.log(this.state.to_marker)),this.state.from_marker.enabled&&this.state.to_marker.enabled&&(JSON.stringify([this.state.from_marker.lngLat.lng,this.state.from_marker.lngLat.lat])!==JSON.stringify(this.state.active_route.coordinates[0])||JSON.stringify([this.state.to_marker.lngLat.lng,this.state.to_marker.lngLat.lat])!==JSON.stringify(this.state.active_route.coordinates[this.state.active_route.coordinates.length-1]))&&this.calculateRoute()}},{key:"onMouseMove",value:function(e,t){!this.state.from_marker.enabled||this.state.from_marker.placed||this.state.from_marker.dragging?!this.state.to_marker.enabled||this.state.to_marker.placed||this.state.to_marker.dragging||(ne.features[0].geometry.coordinates=[t.lngLat.lng,t.lngLat.lat],e.getSource("to_marker").setData(ne)):(ae.features[0].geometry.coordinates=[t.lngLat.lng,t.lngLat.lat],e.getSource("from_marker").setData(ae)),this.state.from_marker.dragging?(ae.features[0].geometry.coordinates=[t.lngLat.lng,t.lngLat.lat],e.getSource("from_marker").setData(ae)):this.state.to_marker.dragging&&(ne.features[0].geometry.coordinates=[t.lngLat.lng,t.lngLat.lat],e.getSource("to_marker").setData(ne))}},{key:"createFromMarker",value:function(){console.log(this.state.from_marker),this.setState(function(e){return{from_marker:{placed:!1,enabled:!0,dragging:e.from_marker.dragging,lngLat:e.from_marker.lngLat}}})}},{key:"createToMarker",value:function(){console.log(this.state.to_marker.lngLat),this.setState(function(e){return{to_marker:{placed:!1,enabled:!0,dragging:e.to_marker.dragging,lngLat:e.to_marker.lngLat}}})}},{key:"render",value:function(){var e=this,t=this.state,a=t.center,n=t.zoom,r=(t.from_marker,t.to_marker,this.state.selected_routes.map(function(t){for(var a=e.state.saved_routes.length,n=0;e.state.saved_routes[n].key!=t&&n<a;)n++;return o.a.createElement(Q.b,{type:"line",layout:oe,paint:se},o.a.createElement(Q.a,{coordinates:e.state.saved_routes[n].coordinates}))}));return o.a.createElement("div",{style:{height:"100%",width:"100%"}},o.a.createElement(ee,{style:{height:"20vh",width:"100vh"},calculating:this.state.calculating,from_marker:this.state.from_marker,to_marker:this.state.to_marker,createFromMarker:this.createFromMarker,createToMarker:this.createToMarker,selectable_routes:this.state.selectable_routes,selected_routes:this.state.selected_routes,handleSelectedRouteAddition:this.handleSelectedRouteAddition,handleSelectedRoutesChange:this.handleSelectedRoutesChange,calculateRoute:this.calculateRoute,saveCurrentRoute:this.saveCurrentRoute}),o.a.createElement(te,{style:"mapbox://styles/mapbox/streets-v11",containerStyle:this.state.container_style,center:a,zoom:n,onStyleLoad:this.onStyleLoad,onMouseMove:this.onMouseMove,onMouseUp:this.onMouseUp,onClick:this.onMouseClick},o.a.createElement(Q.b,{type:"line",layout:oe,paint:re},o.a.createElement(Q.a,{coordinates:this.state.active_route.coordinates})),r))}}]),t}(o.a.Component);var ce=function(e){return o.a.createElement("div",{className:"Right-panel"},o.a.createElement(ie,{configFile:e.configFile,style:{height:"100%",width:"100%"}}))},ue=(a(1068),a(456)),me=a.n(ue),de={"osm:access":["osm:Agricultural","osm:Customers","osm:Delivery","osm:Designated","osm:Destination","osm:Discouraged","osm:Dismount","osm:Emergency","osm:Forestry","osm:NoAccess","osm:Permissive","osm:Private","osm:UseSidepath","osm:FreeAccess"],"osm:barrier":["osm:Block","osm:Bollard","osm:BorderControl","osm:BumpGate","osm:BusTrap","osm:CattleGrid","osm:Chain","osm:CycleBarrier","osm:Debris","osm:Entrance","osm:Gate","osm:LiftGate","osm:SallyPort","osm:SwingGate","osm:TollBooth","osm:Turnstile"],"osm:bicycle":["osm:Designated","osm:Destination","osm:Dismount","osm:NoAccess","osm:OfficialAccess","osm:Permissive","osm:Private","osm:UseSidepath","osm:FreeAccess"],"osm:construction":["osm:UnderConstruction"],"osm:crossing":["osm:Uncontrolled","osm:Unmarked"],"osm:cycleway":["osm:Lane","osm:Opposite","osm:OpposciteLane","osm:OppositeTrack","osm:ShareBusway","osm:Shared","osm:SharedLane","osm:Track"],"osm:footway":["osm:Sidewalk"],"osm:highway":["osm:Bridleway","osm:UnderConstruction","osm:HighwayCrossing","osm:CycleHighway","osm:FootHighway","osm:GiveWay","osm:LivingStreet","osm:Motorway","osm:MotorwayLink","osm:Path","osm:Primary","osm:PrimaryLink","osm:Proposed","osm:Residential","osm:Road","osm:Secondary","osm:SecondaryLink","osm:Service","osm:Steps","osm:Stop","osm:Tertiary","osm:TertiaryLink","osm:Track","osm:TrafficSignals","osm:Trunk","osm:TrunkLink","osm:Unclassified"],"osm:motor_vehicle":["osm:Agricultural","osm:Customers","osm:Delivery","osm:Designated","osm:Destination","osm:NoAccess","osm:Official","osm:Permissive","osm:Private","osm:FreeAccess"],"osm:motorcar":["osm:Agricultural","osm:Customers","osm:Delivery","osm:Designated","osm:Destination","osm:Forestry","osm:NoAccess","osm:Official","osm:Permissive","osm:Private","osm:FreeAccess"],"osm:oneway_bicycle":["osm:InReverseOrder","osm:InOrder","osm:Bidirectional","osm:InOrder"],"osm:oneway":["osm:InReverseOrder","osm:InOrder","osm:InOrder","osm:Bidirectional"],"osm:smoothness":["osm:BadSmoothness","osm:ExcellentSmoothness","osm:GoodSmoothness","osm:HorribleSmoothness","osm:ImpassableSmoothness","osm:IntermediateSmoothness","osm:VeryBadSmoothness","osm:VeryHorribleSmoothness"],"osm:surface":["osm:Asphalt","osm:Cobblestone","osm:Compacted","osm:Concrete","osm:Dirt","osm:Dirt","osm:FineGravel","osm:Grass","osm:Gravel","osm:Ground","osm:Mud","osm:Paved","osm:PavingStones","osm:Pebblestone","osm:Sand","osm:Sett","osm:UnhewnCobblestone","osm:Unpaved","osm:Wood"],"osm:tracktype":["osm:Grade1","osm:Grade2","osm:Grade3","osm:Grade4","osm:Grade5"],"osm:vehicle":["osm:Customers","osm:Delivery","osm:Designated","osm:Destination","osm:Forestry","osm:NoAccess","osm:Permissive","osm:Private","osm:FreeAccess"]},he={hasAccessRules:{conclusion:"hasAccess",type:"boolean",defaultValue:!1},hasObstacleRules:{conclusion:"isObstacle",type:"boolean",defaultValue:!0},hasOnewayRules:{conclusion:"isOneway",type:"boolean",defaultValue:!0},hasPriorityRules:{conclusion:"hasPriority",type:"number",defaultValue:0},hasSpeedRules:{conclusion:"hasSpeed",type:"number",defaultValue:35}};function pe(){return o.a.createElement("header",{className:"App-header"},o.a.createElement("img",{src:me.a,className:"App-logo",alt:"logo"}),o.a.createElement("span",{className:"App-header"}," Configuroute "))}var ge=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(m.a)(this,Object(d.a)(t).call(this,e))).handleFileConfirm=function(e){a.setState({configFile:e,leftLoaded:!0})},a.handleNewRuleSubmit=function(e){var t=!0;if(a.state.configFile[e.ruleType].map(function(a){return!a.match||a.match.hasPredicate!==e.key||a.match.hasObject!==e.value||(t=!1,!1)}),t){var n=Object(i.a)({},a.state.configFile),o=he[e.ruleType].conclusion,r={match:{hasPredicate:e.key,hasObject:e.value},concludes:Object(l.a)({},o,e.conclusion),hasOrder:e.order};n[e.ruleType].unshift(r),a.setState({configFile:n,showModal:!1})}else a.setState({triggerMessage:!0})},a.handleRuleConclusionChange=function(e,t,n){var o=Object(i.a)({},a.state.configFile);o[e][t].concludes[[he[e].conclusion]]=n,a.setState({configFile:o})},a.handleRuleDelete=function(e,t){var n=Object(i.a)({},a.state.configFile);t!==n[e].length-1&&(n[e].splice(t,1),a.setState({configFile:n}))},a.state={configFile:{},leftLoaded:!1},a}return Object(h.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"App"},o.a.createElement(x,{ruleTypes:he,onConfirm:this.handleFileConfirm}),o.a.createElement(pe,null),o.a.createElement("div",{className:"App-content"},o.a.createElement(H,{ruleTypes:he,rulesSelectOptions:de,loaded:this.state.leftLoaded,configFile:this.state.configFile,onNewRuleSubmit:this.handleNewRuleSubmit,onRuleConclusionChange:this.handleRuleConclusionChange,onRuleDelete:this.handleRuleDelete,className:"Left-panel"}),o.a.createElement(ce,{configFile:this.state.configFile})))}}]),t}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(o.a.createElement(ge,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},277:function(e,t,a){},456:function(e,t,a){e.exports=a.p+"static/media/logo.47bb72e5.jpg"},469:function(e,t,a){e.exports=a(1070)},474:function(e,t,a){},653:function(e,t){},654:function(e,t){},673:function(e,t){},675:function(e,t){},763:function(e,t){},766:function(e,t){},775:function(e,t){},776:function(e,t){},951:function(e,t){},952:function(e,t){}},[[469,1,2]]]);
//# sourceMappingURL=main.741787b9.chunk.js.map