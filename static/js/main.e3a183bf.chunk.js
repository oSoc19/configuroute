(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{1091:function(e,t,a){},1092:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(73),l=a.n(o),i=(a(491),a(11)),s=a.n(i),c=a(446),u=a(65),d=a(51),p=a(25),m=a(26),h=a(30),g=a(28),f=a(29),b=a(18),v=a(273),y=a.n(v),k=(a(287),a(477)),_=a(1117),E=a(111),C=a(1094);var w=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).parseConfigurationFile=function(){},a.state={screen:"welcoming",errorMessage:"",configFile:"",file:"",explanation_visible:!1},a.triggerImportFile=a.triggerImportFile.bind(Object(b.a)(a)),a.toggleTextVisibility=a.toggleTextVisibility.bind(Object(b.a)(a)),a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"triggerImportFile",value:function(e){var t=document.getElementsByClassName("import_file_button")[0],a=this.props.ruleTypes;t.click(),t.addEventListener("change",function(n){var r=t.files[0];if(r.type.match(/json.*/)){var o=new FileReader;o.onload=function(t){var n,l=!0;try{null==(n=JSON.parse(o.result))["@context"]&&(l=!1),Object.keys(a).map(function(e){return null!=n[e]&&Array.isArray(n[e])||(l=!1),!0})}catch(i){l=!1}l?e.props.onChangeContent("UPLOAD",{valid:!0,file:r,configFile:JSON.parse(o.result)}):e.props.onChangeContent("UPLOAD",{valid:!1,file:null,configFile:null})},o.readAsText(r)}else e.props.onChangeContent("UPLOAD",{valid:!1,file:null,configFile:null})})}},{key:"toggleTextVisibility",value:function(){this.setState(function(e){return{explanation_visible:!e.explanation_visible}})}},{key:"render",value:function(){var e=this,t=this.state.explanation_visible;return r.a.createElement("div",null,r.a.createElement("div",{style:{textAlign:"center"}},r.a.createElement(k.a,{centered:!0,src:"assets/logo.jpg",className:"centerLogo"}),r.a.createElement("p",{className:"modalTitle"},"Your go-to for creating robust route configurations"),r.a.createElement(_.a.Group,{animation:"fade down",duration:500},t&&r.a.createElement("div",{className:"explanation modalContent"},r.a.createElement("p",null,"Ever traveled with unconventional means of transport such as a scooter? You want to reach specific locations but your route planner takes you through uncomfortable routes? We believe your journey should always be adapted to your very specific mobility needs. For this reason, we created ConfiguRoute: a tool to quickly and easily create finely tuned configuration files for your transport profiles."),r.a.createElement("p",null,"Transport profiles are defined using linked open data and OpenStreetMap terminologies. More information can be found at \xa0",r.a.createElement("a",{className:"modalContent",href:"http://hdelva.be/profile/ns/profile.html",target:"_blank",rel:" noopener noreferrer"},"the profile defenition ontology"),"."))),r.a.createElement("a",{className:"color_white ",onClick:function(){e.toggleTextVisibility()}},t?"Read less":"Read more",r.a.createElement(E.a,{name:t?"angle up":"angle down",size:"large"}))),r.a.createElement("div",{className:"horizontalContainer"},r.a.createElement("button",{className:"button color_white background_green",onClick:function(){e.props.onChangeContent("NEW")}},r.a.createElement(E.a,{name:"plus",style:{width:"20%"}}),r.a.createElement("span",{className:"border_right"},"Create new")),r.a.createElement("span",{className:"textUppercase color_white buttonDevider"},"or"),r.a.createElement("button",{className:"button color_white background_green",onClick:function(){e.triggerImportFile(e)}},r.a.createElement(E.a,{name:"download",style:{width:"20%"}}),r.a.createElement("input",{type:"file",className:"import_file_button",multiple:"",style:{display:"none"},accept:".json"}),r.a.createElement("span",{className:"border_right",style:{paddingTop:"3px"}},"Import file"))))}}]),t}(r.a.Component),O=a(1113),S=a(161),j=a(1115),x=a(1101);var L=function(e){return r.a.createElement(C.a,{icon:!0,labelPosition:"left",className:"landing_page_button",onClick:e.onClick,style:{padding:0,margin:0,height:"100%",borderRadius:"0 0 0 12px"}},r.a.createElement(E.a,{name:"left arrow",style:{width:"20%"},size:"large"}),"Go back")};var T=function(e){return r.a.createElement(C.a,{icon:!0,labelPosition:"right",className:"landing_page_button",onClick:e.onClick,disabled:e.disabled,style:{padding:0,margin:0,height:"100%",borderRadius:"0px 0px 12px 0px"}},r.a.createElement(E.a,{name:"check",style:{width:"20%"},size:"large"}),e.label?e.label:"Confirm selection")},M=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).validFileScreen=a.validFileScreen.bind(Object(b.a)(a)),a.errorScreen=a.errorScreen.bind(Object(b.a)(a)),a.state={dimmerActive:!1},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"computeNumberOfRules",value:function(){var e=this,t=0;return void 0===this.props.data.configFile?t:(Object.keys(this.props.ruleTypes).map(function(a){return t+=e.props.data.configFile[a].length}),t)}},{key:"validFileScreen",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",{className:"color_white",style:{margin:"12px"}}," ",this.props.data.file.name," "),r.a.createElement(O.a,{style:{margin:"12px"}},r.a.createElement(S.a,null," Size: ")," ",this.props.data.file.size+" bytes"),r.a.createElement(O.a,{style:{margin:"12px"}},r.a.createElement(S.a,null," Label: ")," ",this.props.data.configFile["rdfs:label"]," "),r.a.createElement(O.a,{style:{margin:"12px"}},r.a.createElement(S.a,null," Number of rules: ")," ",this.computeNumberOfRules()))}},{key:"errorScreen",value:function(){return r.a.createElement("h2",{className:"color_white"}," Format unsupported ")}},{key:"content",value:function(){return this.props.data.valid?r.a.createElement(this.validFileScreen,null):r.a.createElement(this.errorScreen,null)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(j.a,{active:this.state.dimmerActive},r.a.createElement(x.a,{size:"huge"},"Loading")),this.content(),r.a.createElement("div",{className:"horizontalContainer"},r.a.createElement("button",{className:"button_secondary color_dark_blue background_white",onClick:this.props.onBack},r.a.createElement(E.a,{name:"arrow left"}),r.a.createElement("span",null,"Go back")),r.a.createElement("button",{className:"button color_white background_green",onClick:function(){e.setState({dimmerActive:!0}),e.props.onConfirm(e.props.data.configFile)}},r.a.createElement(E.a,{name:"checkmark",style:{width:"20%"},size:"large"}),r.a.createElement("span",{style:{paddingTop:"3px"}},"Confirm selection"))))}}]),t}(r.a.Component),R=a(1106),N=a(1111),F=a(1104),P={"@context":{osm:"https://w3id.org/openstreetmap/terms#",opp:"https://w3id.org/openplannerteam/profile#",prov:"http://www.w3.org/ns/prov#",hasMaxSpeed:{"@id":"opp:hasMaxSpeed"},usePublicTransport:{"@id":"opp:usePublicTransport"},hasAccessRules:{"@id":"opp:hasAccessRules"},hasOnewayRules:{"@id":"opp:hasOnewayRules"},hasSpeedRules:{"@id":"opp:hasSpeedRules"},hasPriorityRules:{"@id":"opp:hasPriorityRules"},hasObstacleRules:{"@id":"opp:hasObstacleRules"},hasAccess:{"@id":"opp:hasAccess"},isOneway:{"@id":"opp:isOneway"},isReversed:{"@id":"opp:isReversed"},hasSpeed:{"@id":"opp:hasSpeed"},isObstacle:{"@id":"opp:isObstacle"},hasPriority:{"@id":"opp:hasPriority"},concludes:{"@id":"opp:concludes"},hasOrder:{"@id":"opp:hasOrder"},match:{"@id":"opp:match"},fromProperty:{"@id":"opp:fromProperty","@type":"@id"},hasPredicate:{"@id":"opp:hasPredicate","@type":"@id"},hasObject:{"@id":"opp:hasObject","@type":"@id"}}},D=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).onNewConfigFileCreation=function(e){var t=a.props.ruleTypes,n=P;return n["rdfs:label"]=e.description,n.hasMaxSpeed=Number(e.maxSpeed),n.usePublicTransport=e.usePublicTransport,Object.keys(a.props.ruleTypes).map(function(e){n[e]=[];var a={concludes:{}};return a.concludes[t[e].conclusion]=t[e].defaultValue,a.hasOrder=100,n[e].push(a),e}),n},a.handleChange=function(e,t){var n=t.name,r=t.value;return a.setState(Object(u.a)({},n,r))},a.state={description:"",maxSpeed:"",usePublicTransport:!1,showErrorMessage:!1,dimmerActive:!1},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"form",value:function(){var e=this,t=this.state,a=t.description,n=t.maxSpeed,o=t.usePublicTransport;return r.a.createElement(R.a,{inverted:!0},r.a.createElement(R.a.Input,{label:"Description",placeholder:"Vehicle profile for...",name:"description",value:a,onChange:this.handleChange,required:!0}),r.a.createElement(R.a.Input,{type:"number",label:"Maximum speed",placeholder:"Speed in km/h",name:"maxSpeed",value:n,onChange:this.handleChange,required:!0}),r.a.createElement(R.a.Checkbox,{label:"Use public transport",onChange:function(){e.setState({usePublicTransport:!o})},checked:o}),this.state.showErrorMessage&&r.a.createElement(N.a,{negative:!0},r.a.createElement(N.a.Header,null,"All field values must be filled in"),r.a.createElement("p",null,"Enter a description and the maximum speed of the vehicle.")))}},{key:"startFromProfile",value:function(e,t){var a=new XMLHttpRequest;a.open("GET",t,!0),a.send(null),a.onreadystatechange=function(){4===a.readyState&&200===a.status&&(1!==a.getResponseHeader("Content-Type").indexOf("text")?e.props.onConfirm(JSON.parse(a.responseText)):alert("Error happened: link to file modified or removed!"))},this.setState({dimmerActive:!0})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(j.a,{active:this.state.dimmerActive},r.a.createElement(x.a,{size:"huge"},"Loading")),r.a.createElement("div",{className:"new_file_from"},r.a.createElement("h2",{className:"color_white"},"Start from a default profile"),r.a.createElement("div",{className:"profiles_container"},r.a.createElement("button",{className:"background_white button_profile",name:"car",onClick:function(){e.startFromProfile(e,"https://raw.githubusercontent.com/oSoc19/configuroute/master/default_profiles/car.json")}},r.a.createElement(E.a,{name:"car",size:"huge"})),r.a.createElement("button",{className:"background_white button_profile",name:"bike",onClick:function(){e.startFromProfile(e,"https://raw.githubusercontent.com/oSoc19/configuroute/master/default_profiles/bike.json")}},r.a.createElement(E.a,{name:"bicycle",size:"huge"})),r.a.createElement("button",{className:"background_white button_profile",name:"default profiles",onClick:function(){e.startFromProfile(e,"https://raw.githubusercontent.com/oSoc19/configuroute/master/default_profiles/pedestrian.json")}},r.a.createElement(E.a,{name:"blind",size:"huge"}))),r.a.createElement(F.a,{inverted:!0,horizontal:!0},"or"),r.a.createElement("h2",{className:"color_white"}," Start from scratch "),this.form()),r.a.createElement("div",{className:"horizontalContainer"},r.a.createElement("button",{className:"button_secondary color_dark_blue background_white",onClick:this.props.onBack},r.a.createElement(E.a,{name:"arrow left"}),r.a.createElement("span",null,"Go back")),r.a.createElement("button",{className:"button color_white background_green",onClick:function(){var t=!1;Object.keys(e.state).map(function(a){return""!==e.state[a]&&null!==e.state[a]||(t=!0),a}),t?e.setState({showErrorMessage:!0}):(e.setState({dimmerActive:!0}),e.props.onConfirm(e.onNewConfigFileCreation(e.state)))}},r.a.createElement(E.a,{name:"checkmark",style:{width:"20%"},size:"large"}),r.a.createElement("span",{style:{paddingTop:"3px"}},"Confirm selection"))))}}]),t}(r.a.Component),A={content:{width:"60%",height:"60%",padding:0,borderRadius:"5px",outline:"none",border:"none",top:"50%",left:"50%",position:"absolute",marginRight:"-50%",transform:"translate(-50%, -50%)",backgroundColor:"#0B132B"},overlay:{backgroundColor:"rgba(255, 255, 255, 0.7)"}};y.a.setAppElement("#root");var I=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).content=function(){switch(a.state.content){case"INDEX":return r.a.createElement(w,{ruleTypes:a.props.ruleTypes,onChangeContent:a.handleChangeContent});case"UPLOAD":return r.a.createElement(M,{ruleTypes:a.props.ruleTypes,onConfirm:a.handleConfirm,onBack:function(){a.handleChangeContent("INDEX")},data:a.state.fileData,onChangeContent:a.handleChangeContent});case"NEW":return r.a.createElement(D,{ruleTypes:a.props.ruleTypes,onConfirm:a.handleConfirm,onBack:function(){a.handleChangeContent("INDEX")},onChangeContent:a.handleChangeContent});default:return null}},a.state={content:"INDEX",fileData:{}},a.handleChangeContent=a.handleChangeContent.bind(Object(b.a)(a)),a.handleConfirm=a.handleConfirm.bind(Object(b.a)(a)),a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"handleChangeContent",value:function(e,t){this.setState({content:e,fileData:t})}},{key:"handleConfirm",value:function(e){this.props.onConfirm(e)}},{key:"render",value:function(){return r.a.createElement(y.a,{isOpen:this.props.showModal,contentLabel:"Landing Page",style:A},r.a.createElement(this.content,null))}}]),t}(r.a.Component),V=a(110),B=a(1114),z=a(1109),U=a(1107);function W(e){return r.a.createElement(z.a,null,r.a.createElement(z.a.Content,null,r.a.createElement(z.a.Header,{as:"a",href:e.href,target:"_blank"},e.header),r.a.createElement(z.a.Meta,null,"Description"),r.a.createElement(z.a.Description,null,e.description)))}var q=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).handleChange=function(e,t){var n=t.name,r=t.value;a.setState(Object(u.a)({},n,r))},a.handleChangeChecked=function(e){return a.setState({conclusion:!a.state.conclusion})},a.content=function(){return r.a.createElement(B.a,{centered:!0,style:{height:"100%",margin:0}},r.a.createElement(B.a.Row,{columns:1,stretched:!0,style:{height:"50%",padding:"12px"}},r.a.createElement(B.a.Column,{className:"contentColumn"},a.form()," ")),r.a.createElement(B.a.Row,{columns:2,stretched:!0,style:{height:"50px",padding:"0"}},r.a.createElement(C.a.Group,{style:{width:"100%",padding:0}},r.a.createElement(L,{onClick:a.props.onClose}),r.a.createElement(C.a.Or,null),r.a.createElement(T,{onClick:function(){var e=!1;Object.keys(a.state).map(function(t){return""!==a.state[t]&&null!==a.state[t]||(e=!0),t}),e?a.setState({showErrorMessage:!0}):a.props.onSubmit(a.state)}}))))},a.state={showModal:!0,ruleType:"",key:"",value:"",conclusion:"",order:1,prefix:"https://w3id.org/openstreetmap/terms#",rulesLink:"http://hdelva.be/profile/ns/profile.html#"},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"insertCharacterInString",value:function(e,t,a){if(e.length>t)return e.slice(0,t)+a+e.slice(t)}},{key:"beautifyString",value:function(e){for(var t=this,a=[],n=e.slice(0),r=1;r<n.length;r++){var o=a.length+r;r&&n[r]===n[r].toUpperCase()&&a.push(o)}return a.map(function(e){return n=t.insertCharacterInString(n,e," ")}),n}},{key:"form",value:function(){var e,t=this,a=Object.keys(this.props.ruleTypes).map(function(e){return{key:e,value:e,text:t.beautifyString(e.slice(3))}}),n=this.props.selectOptions.tags,o=Object.keys(n).map(function(e){return{key:e,value:e,text:e}}),l=this.state.key?n[this.state.key].values.map(function(e){return{key:e,value:e,text:e}}):[];if(this.state.ruleType&&"number"===this.props.ruleTypes[this.state.ruleType].type)e=r.a.createElement(R.a.Input,{type:"number",name:"conclusion",placeholder:this.props.ruleTypes[this.state.ruleType].conclusion,label:"conclusion",onChange:this.handleChange,value:this.state.conclusion,required:!0});else if(this.state.ruleType){var i=this.props.ruleTypes[this.state.ruleType].conclusion;e=r.a.createElement(R.a.Checkbox,{name:"conclusion",placeholder:i,label:i,onChange:this.handleChangeChecked,checked:this.state.conclusion,defaultChecked:!1,slider:!0})}else e=null;return r.a.createElement(r.a.Fragment,null,r.a.createElement(R.a,null,r.a.createElement(R.a.Select,{name:"ruleType",placeholder:"Type of rule",label:"Rule",options:a,onChange:this.handleChange,value:this.state.ruleType}),r.a.createElement(R.a.Group,null,r.a.createElement(R.a.Select,{name:"key",placeholder:"Condition key",label:"key",options:o,onChange:this.handleChange,value:this.state.key}),r.a.createElement(R.a.Select,{name:"value",placeholder:"Condition value",label:"value",options:l,onChange:this.handleChange,value:this.state.value})),r.a.createElement(R.a.Group,null),e,r.a.createElement(R.a.Input,{name:"order",placeholder:"Order of priority",label:"Order of priority",onChange:this.handleChange,value:this.state.order}),this.state.showErrorMessage&&r.a.createElement(O.a,null," ",r.a.createElement(S.a,null," All field values must be completed "))),r.a.createElement(z.a.Group,{divided:!0},this.state.ruleType&&r.a.createElement(W,{href:this.state.rulesLink+this.state.ruleType,header:this.state.ruleType.slice(3),description:this.props.ruleTypes[this.state.ruleType].description}),this.state.key&&r.a.createElement(W,{href:this.props.getTagLink(this.state.key),header:this.state.key,description:this.props.getTagComment(this.state.key)}),this.state.value&&r.a.createElement(W,{href:this.props.getValueLink(this.state.value),header:this.state.value.toLowerCase(),description:this.props.getValueComment(this.state.value)})))}},{key:"render",value:function(){return r.a.createElement(U.a,{open:this.props.showModal,style:{"border-radius":"12px"}},r.a.createElement(this.content,null))}}]),t}(r.a.Component),G=a(1110),J=a(1103),K=a(1102),H=a(1108),X=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).handleChange=function(e,t){var n=t.value,r=t.checked;void 0===n?a.props.onChange(a.props.type,a.props.index,r):a.props.onChange(a.props.type,a.props.index,n)},a.handleCloseModal=function(){a.setState({showModal:!1})},a.handleOpenModal=function(){a.setState({showModal:!0})},a.popupContent=function(){if(a.props.rule.match){var e=a.props.rule.match.hasPredicate;e=e?e.slice(4):e;var t=a.props.rule.match.hasObject;return t=t?t.slice(4):t,r.a.createElement(z.a.Group,null,e&&r.a.createElement(W,{href:a.props.getTagLink(e),header:e,description:a.props.getTagComment(e)}),t&&r.a.createElement(W,{href:a.props.getValueLink(t),header:t,description:a.props.getValueComment(t)}))}return null},a.state={showModal:!1},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"content",value:function(){var e,t=Object.keys(this.props.rule.concludes)[0];switch(typeof this.props.rule.concludes[t]){case"string":e=r.a.createElement(J.a,{value:this.props.rule.concludes[t],onChange:this.handleChange});break;case"number":e=r.a.createElement(J.a,{type:"number",value:this.props.rule.concludes[t],onChange:this.handleChange});break;case"boolean":e=r.a.createElement(K.a,{toggle:!0,checked:this.props.rule.concludes[t],onChange:this.handleChange});break;default:e=null}return r.a.createElement(O.a,{style:{marginRight:0}},t," ",e)}},{key:"render",value:function(){var e,t=this;return e=this.props.rule.match?(e=this.props.rule.match.hasPredicate+" - "+this.props.rule.match.hasObject).replace(/osm:/g,""):"Default rule",this.props.display?r.a.createElement(z.a,null,r.a.createElement(z.a.Content,null,r.a.createElement("h3",{className:"color_white"}," ",e," "),r.a.createElement(z.a.Description,null),r.a.createElement(z.a.Meta,null,this.content(),r.a.createElement(C.a.Group,{style:{width:"100%"}},r.a.createElement(C.a,{onClick:function(){t.props.onDelete(t.props.type,t.props.index)},icon:!0,disabled:"Default rule"===e},r.a.createElement(E.a,{name:"trash alternate outline"})),r.a.createElement(C.a.Or,null),r.a.createElement(H.a,{hideOnScroll:!0,trigger:r.a.createElement(C.a,{onClick:function(){t.handleOpenModal()},icon:!0},r.a.createElement(E.a,{name:"info"})),content:this.popupContent(),on:"click",open:this.state.showModal,onClose:this.handleCloseModal,onOpen:this.handleOpenModal,position:"top right"}))," "))):null}}]),t}(r.a.Component),Y=a(476),Z=a(471),Q=a.n(Z);function $(e){return r.a.createElement(U.a,{open:e.open,style:{width:"60vw",height:"70vh"}},r.a.createElement(Y.a,{id:"configFile_editor",placeholder:e.configFile,locale:Q.a,height:"100%",width:"60vw",viewOnly:!0}),r.a.createElement(C.a.Group,{style:{width:"60vw",height:"8%"}},r.a.createElement(L,{onClick:e.onClose})))}var ee=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).handleChange=function(e,t){var n,r=t.name,o=t.value,l=t.checked;"transport"===r?a.setState({transport:l,modified:!0}):a.setState((n={},Object(u.a)(n,r,o),Object(u.a)(n,"modified",!0),n))},a.form=function(){return r.a.createElement(R.a,null,r.a.createElement(R.a.Input,{name:"label",label:"description:",onChange:a.handleChange,value:a.state.label,required:!0}),r.a.createElement(R.a.Input,{type:"number",name:"speed",label:"maximum speed:",onChange:a.handleChange,value:a.state.speed,required:!0}),r.a.createElement(R.a.Checkbox,{name:"transport",label:"can be taken on public transport:",onChange:a.handleChange,checked:a.state.transport,slider:!0}))},console.log(e.transport),a.state={label:e.label,speed:e.speed,transport:e.transport,modified:!1},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement(U.a,{open:this.props.isOpen},r.a.createElement(B.a,{centered:!0,style:{height:"100%",margin:0}},r.a.createElement(B.a.Row,{columns:1,stretched:!0,style:{height:"50%",padding:"12px"}},r.a.createElement(B.a.Column,{className:"contentColumn"},this.form()," ")),r.a.createElement(B.a.Row,{columns:2,stretched:!0,style:{height:"50px",padding:"0"}},r.a.createElement(C.a.Group,{style:{width:"100%"}},r.a.createElement(L,{onClick:this.props.onClose}),r.a.createElement(C.a.Or,null),r.a.createElement(T,{disabled:!this.state.modified,label:"Update properties",onClick:function(){e.props.onConfirm(e.state)}})))))}}]),t}(r.a.Component),te=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).handleCloseModal=function(){a.setState({showModal:!1})},a.handleClick=function(e){var t=parseInt(e.target.id),n=a.state.activeIndex===t?-1:t;a.setState({activeIndex:n})},a.handleSubmit=function(e){var t=Object.keys(a.props.ruleTypes).indexOf(e.ruleType)+1;t!==a.state.activeIndex&&a.setState({activeIndex:t}),a.handleCloseModal(),a.props.onNewRuleSubmit(e)},a.displayBasicProperties=function(){return r.a.createElement(r.a.Fragment,{key:0},Object.keys(a.props.configFile).map(function(e){var t=a.props.configFile[e];if(!Array.isArray(t)&&"object"!==typeof t){var n=a.beautifyString(e)+": ";return r.a.createElement("div",{className:"color_white basic_properties",key:n},r.a.createElement("span",null,n),r.a.createElement("span",null,r.a.createElement("b",null,String(t))))}}))},a.generateDropdownOptions=function(){if(!a.props.loaded)return[];var e=a.props.rulesSelectOptions.tags,t=Object.keys(e).map(function(e){return{key:e,value:e,text:e}}),n=a.props.rulesSelectOptions.values,r=Object.keys(n).map(function(e){return{key:e,value:e,text:e}});return[].concat(Object(V.a)(t),Object(V.a)(r))},a.handleSelectedKeywordsChange=function(e,t){var n=t.value;a.setState({selectedKeywords:n})},a.download=function(){var e=document.createElement("a");e.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(JSON.stringify(a.props.configFile,null,2))),e.setAttribute("download","config.json"),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)},a.getLink=function(e){var t="";return Object.keys(e).map(function(a){return"wasInfluencedBy"===a.slice(a.indexOf("#")+1)&&(t=e[a]),a}),t},a.getComment=function(e){var t="";return Object.keys(e).map(function(a){return"comment"===a.slice(a.indexOf("#")+1)&&(t=e[a]),a}),t},a.getTagComment=function(e){if(!a.props.rulesSelectOptions.tags[e])return"";var t=a.props.rulesSelectOptions.tags[e].description;return t?a.getComment(t):void 0},a.getValueComment=function(e){if(!a.props.rulesSelectOptions.values[e])return"";var t=a.props.rulesSelectOptions.values[e];return t?a.getComment(t):void 0},a.getTagLink=function(e){if(!a.props.rulesSelectOptions.tags[e])return"";var t=a.props.rulesSelectOptions.tags[e].description;return t?a.getLink(t):void 0},a.getValueLink=function(e){if(!a.props.rulesSelectOptions.values[e])return"";var t=a.props.rulesSelectOptions.values[e];return t?a.getLink(t):void 0},a.state={showModal:!1,showConfigFile:!1,activeIndex:0,selectedKeywords:[],showBasicPropertiesModal:!1},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"rulesMatchesKeyword",value:function(e){var t=this;if(this.state.selectedKeywords.length>0){if(e.match){var a=[e.match.hasPredicate.slice(4)];return e.match.hasObject&&a.push(e.match.hasObject.slice(4)),a.map(function(e){return!!t.state.selectedKeywords.includes(e)}).includes(!0)}return!1}return!0}},{key:"insertCharacterInString",value:function(e,t,a){if(e.length>t)return e.slice(0,t)+a+e.slice(t)}},{key:"beautifyString",value:function(e){for(var t=this,a=[],n=e.slice(0),r=1;r<n.length;r++){var o=a.length+r;r&&n[r]===n[r].toUpperCase()&&a.push(o)}switch(a.map(function(e){return n=t.insertCharacterInString(n,e," ")}),n){case"rdfs :label":return"Profile";case"has Max Speed":return"Max-speed";case"use Public Transport":return"Public transportation"}return n}},{key:"displayContent",value:function(){var e=this;if(this.props.loaded){var t=0;return Object.keys(this.props.ruleTypes).map(function(a){t++;var n=0,o=0;return r.a.createElement("div",{key:t},r.a.createElement("button",{className:e.state.activeIndex===t?"accordion active":"accordion",id:t,onClick:function(t){e.handleClick(t)}},r.a.createElement("span",{id:t,onClick:function(t){e.handleClick(t)}},e.beautifyString(a.slice(3))),r.a.createElement(E.a,{name:"chevron down",size:"small",id:t,style:{paddingTop:"4px"}})),r.a.createElement("div",{className:"accordion_panel",style:e.state.activeIndex===t?{display:"block"}:{display:"none"}},r.a.createElement(z.a.Group,{divided:!0},e.props.configFile[a].map(function(t){return e.rulesMatchesKeyword(t)&&o++,r.a.createElement(X,{display:e.rulesMatchesKeyword(t),type:a,index:n++,key:JSON.stringify(t),rule:t,onChange:e.props.onRuleConclusionChange,onDelete:e.props.onRuleDelete,getValueLink:e.getValueLink,getValueComment:e.getValueComment,getTagLink:e.getTagLink,getTagComment:e.getTagComment})})),0===o&&r.a.createElement("div",{className:"color_white"},r.a.createElement("p",null,"Nothing to see here, try adding some rules!"))))})}return null}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"Left-panel background_darkblue"},r.a.createElement("img",{src:"assets/logo.jpg",alt:"configuroute logo",width:"113px",height:"113px"}),r.a.createElement("div",{className:"left_pannel_container"},r.a.createElement("div",null,this.displayBasicProperties(),r.a.createElement("div",{className:"basic_properties_options"},r.a.createElement(G.a,{icon:"ellipsis vertical",pointing:!0,className:"link item color_white"},r.a.createElement(G.a.Menu,null,r.a.createElement(G.a.Item,{onClick:function(){e.setState({showConfigFile:!0})}},"Show file"),r.a.createElement(G.a.Item,{onClick:this.download},"Download file"))),r.a.createElement("button",{className:"edit_properties_button",onClick:function(){e.setState({showBasicPropertiesModal:!0})}},r.a.createElement(E.a,{inverted:!0,name:"pencil"})))),this.state.showModal&&r.a.createElement(q,{showModal:this.state.showModal,ruleTypes:this.props.ruleTypes,selectOptions:this.props.rulesSelectOptions,onSubmit:this.handleSubmit,onClose:this.handleCloseModal,beautifyString:this.beautifyString,getValueLink:this.getValueLink,getValueComment:this.getValueComment,getTagLink:this.getTagLink,getTagComment:this.getTagComment}),this.state.showConfigFile&&r.a.createElement($,{ruleTypes:this.props.ruleTypes,open:this.state.showConfigFile,configFile:this.props.configFile,onClose:function(){e.setState({showConfigFile:!1})}}),this.state.showBasicPropertiesModal&&r.a.createElement(ee,{isOpen:this.state.showBasicPropertiesModal,onClose:function(){e.setState({showBasicPropertiesModal:!1})},label:this.props.configFile["rdfs:label"],speed:this.props.configFile.hasMaxSpeed,transport:this.props.configFile.usePublicTransport,onConfirm:function(t){e.props.onChangeBasicProperties(t),e.setState({showBasicPropertiesModal:!1})}}),r.a.createElement("div",{className:"rules_edit_container"},r.a.createElement("div",{className:"filter_container"},r.a.createElement(G.a,{style:{width:"200px"},placeholder:"Filter",search:!0,selection:!0,icon:"filter",options:this.generateDropdownOptions(),value:this.state.selectedKeywords,onChange:this.handleSelectedKeywordsChange}),r.a.createElement("button",{className:"filter_clear",onClick:function(){e.setState({selectedKeywords:[]})}},r.a.createElement(E.a,{name:"close"}))),r.a.createElement("button",{className:"button color_white background_green",onClick:function(){e.setState({showModal:!0})}},r.a.createElement(E.a,{name:"plus",style:{width:"20%"}}),r.a.createElement("span",{className:"border_right"},"Add a rule"))),r.a.createElement("div",{className:"acordion_container"},this.displayContent())))}}]),t}(r.a.Component),ae=a(472),ne=a(112),re=a(1105),oe=a(1112);function le(e){return r.a.createElement(C.a,{disabled:e.disabled,as:"div",labelPosition:"right",onClick:e.onClick,style:e.style},r.a.createElement(C.a,{className:"marker_button",icon:!0},r.a.createElement(E.a,{name:"map pin"}),e.children),r.a.createElement(S.a,{as:"a",basic:!0,pointing:"left"},e.marker.placed&&Math.round(1e4*e.marker.lngLat.lat)/1e4+", "+Math.round(1e4*e.marker.lngLat.lng)/1e4))}var ie=function(e){function t(e){return Object(p.a)(this,t),Object(h.a)(this,Object(g.a)(t).call(this,e))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props,t=e.calculating,a=e.from_marker,n=e.to_marker,o=e.selectable_routes,l=e.selected_routes,i=e.handleSelectedRouteAddition,s=e.handleSelectedRoutesChange,c=e.calculateRoute,u=e.saveCurrentRoute,d=e.createToMarker,p=e.createFromMarker,m=e.updateActiveRouteText,h=e.active_route_label_error;return r.a.createElement(re.a,{className:"mapToolbar",style:this.props.style},r.a.createElement(oe.a,{attached:"top",style:{margin:0,border:"none",borderRadius:0,height:"50%"}},r.a.createElement(oe.a.Item,null,r.a.createElement(le,{disabled:t,onClick:function(){p()},marker:a,style:{marginRight:"10px"}},"From"),r.a.createElement(le,{disabled:t,onClick:function(){d()},marker:n},"To")),r.a.createElement(oe.a.Item,null,r.a.createElement("button",{className:"button background_green color_white",disabled:!(a.lngLat&&n.lngLat)||t,loading:t,onClick:function(){c()}},r.a.createElement(E.a,{name:"sync alternate",inverted:!0,style:{width:"20%"}}),r.a.createElement("span",{className:"border_right"},"Calculate"))),r.a.createElement(oe.a.Item,{position:"right"},r.a.createElement(J.a,{type:"text",placeholder:"name",onChange:function(e){m(e)},value:this.props.active_route_label_input,action:!0,disabled:!(a.lngLat&&n.lngLat)||t},r.a.createElement("input",{className:"prompt"}),r.a.createElement(C.a,{className:"semantic_green_override",type:"submit",onClick:function(){u()},disabled:!(a.lngLat&&n.lngLat)||t},"Save route")),h&&r.a.createElement(S.a,{basic:!0,color:"red",pointing:"left"},h))),r.a.createElement(O.a,{attached:"bottom",style:{margin:0,border:"none",borderRadius:0,height:"50%"}},r.a.createElement(G.a,{options:o,placeholder:"Choose routes to display",search:!0,selection:!0,fluid:!0,multiple:!0,allowAdditions:!0,value:l,onAddItem:i,onChange:s,className:"routeSelectDropdown"})))}}]),t}(r.a.Component),se={WebkitTouchCallout:"none",WebkitUserSelect:"none",KhtmlUserSelect:"none",MozUserSelect:"none",MsUserSelect:"none",UserSelect:"none"},ce=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(g.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.features;return r.a.createElement("div",null,r.a.createElement("div",null,e.map(function(e,t){var a=e.layer.id;return a.startsWith("from_marker")?r.a.createElement("div",{key:t},r.a.createElement("strong",{style:se},"From Marker"),r.a.createElement("hr",null)):a.startsWith("to_marker")?r.a.createElement("div",{key:t},r.a.createElement("strong",{style:se},"To Marker"),r.a.createElement("hr",null)):r.a.createElement("div",{key:t},r.a.createElement("strong",{style:se},e.layer["source-layer"],":"),r.a.createElement("span",{style:se},e.layer.id))})))}}]),t}(r.a.Component),ue=(a(669),Object(ne.d)({accessToken:"pk.eyJ1IjoiZ3VndWwiLCJhIjoiY2p4cDVqZXZvMGN6ejNjcm5zdjF6OWR1dSJ9._vc_H7CbewiDCHWYvD4CdQ"})),de={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[0,0]}}]},pe={type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[0,0]}}]},me={"line-cap":"round","line-join":"round"},he={"line-color":"#28A987","line-width":8},ge={"line-color":"#0B3463","line-width":5},fe={height:"100%",width:"100%",cursor:""},be=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).handleSelectedRouteAddition=function(e,t){var n=t.value;console.log("hadleAddition value"),console.log(n),a.setState(function(e){return{selectable_routes:[].concat(Object(V.a)(e.selectable_routes),[{key:n,text:n,value:n}])}})},a.handleSelectedRoutesChange=function(e,t){var n=t.value;console.log("hadleChange value"),console.log(n),console.log(a.state.saved_routes),a.setState({selected_routes:n})},a.state={center:[4.5118,50.6282],zoom:[6.83],calculating:!1,map_features:void 0,show_tooltip:!0,cursor_location:[4.5118,50.6282],from_marker:{placed:!1,enabled:!0,visible:!1,dragging:!1,lngLat:void 0},to_marker:{placed:!1,enabled:!1,dragging:!1,visible:!1,lngLat:void 0},active_route:{key:void 0,text:void 0,coordinates:[]},saved_routes:[],selectable_routes:[],selected_routes:[],container_style:fe,active_route_label_input:"",active_route_label_error:void 0},a.createFromMarker=a.createFromMarker.bind(Object(b.a)(a)),a.createToMarker=a.createToMarker.bind(Object(b.a)(a)),a.onStyleLoad=a.onStyleLoad.bind(Object(b.a)(a)),a.onMouseMove=a.onMouseMove.bind(Object(b.a)(a)),a.onMouseClick=a.onMouseClick.bind(Object(b.a)(a)),a.calculateRoute=a.calculateRoute.bind(Object(b.a)(a)),a.handleSelectedRoutesChange=a.handleSelectedRoutesChange.bind(Object(b.a)(a)),a.handleSelectedRouteAddition=a.handleSelectedRouteAddition.bind(Object(b.a)(a)),a.onMouseUp=a.onMouseUp.bind(Object(b.a)(a)),a.saveCurrentRoute=a.saveCurrentRoute.bind(Object(b.a)(a)),a.updateActiveRouteText=a.updateActiveRouteText.bind(Object(b.a)(a)),a.onMouseLeave=a.onMouseLeave.bind(Object(b.a)(a)),a.planner=new ae.Planner,a.planner.setProfileID("PEDESTRIAN"),a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"componentDidUpdate",value:function(e){e.configFile!==this.props.configFile&&this.planner.setDevelopmentProfile(this.props.configFile)}},{key:"calculateRoute",value:function(){var e=this;if(this.state.from_marker.placed&&this.state.to_marker.placed&&!this.state.calculating){this.setState({calculating:!0});var t={roadNetworkOnly:!0,from:{latitude:this.state.from_marker.lngLat.lat,longitude:this.state.from_marker.lngLat.lng},to:{latitude:this.state.to_marker.lngLat.lat,longitude:this.state.to_marker.lngLat.lng}};this.planner.query(t).take(1).on("error",function(t){console.log("planner.js gave an error:"),console.log(t),e.setState({calculating:!1})}).on("data",function(t){var a=[];t.steps.forEach(function(e){a.push([e.startLocation.longitude,e.startLocation.latitude]),a.push([e.stopLocation.longitude,e.stopLocation.latitude])});var n=new Date;e.setState(function(e){return{active_route:{key:e.saved_routes.length,text:n.toISOString(),coordinates:a}}})}).on("end",function(){console.log("end\n"),e.setState({calculating:!1})})}}},{key:"saveCurrentRoute",value:function(){var e=this;this.setState(function(e){return{active_route:{key:e.active_route.key,text:e.active_route_label_input,coordinates:e.active_route.coordinates}}});var t=this.state.active_route.key,a=this.state.active_route_label_input,n=!1;this.state.saved_routes.forEach(function(r){return r.key===t?(e.setState({active_route_label_error:"route already saved!"}),void(n=!0)):(console.log(r.text+" - "+a),0===r.text.localeCompare(a)?(e.setState({active_route_label_error:"already used that name!"}),void(n=!0)):void 0)}),n||this.setState(function(e){return{saved_routes:[e.active_route].concat(Object(V.a)(e.saved_routes)),selectable_routes:[{key:e.active_route.key,text:e.active_route.text,value:e.active_route.key}].concat(Object(V.a)(e.selectable_routes)),active_route_label_input:""}}),console.log(this.state.saved_routes)}},{key:"updateActiveRouteText",value:function(e){this.setState({active_route_label_input:e.target.value,active_route_label_error:void 0})}},{key:"onMouseUp",value:function(e,t){var a=t.lngLat;this.state.from_marker.dragging?(this.setState(function(e){return{from_marker:{placed:e.from_marker.placed,enabled:e.from_marker.enabled,visible:e.from_marker.visible,dragging:!1,lngLat:a}}}),this.calculateRoute()):this.state.to_marker.dragging&&(this.setState(function(e){return{to_marker:{placed:e.to_marker.placed,enabled:e.to_marker.enabled,visible:e.to_marker.visible,dragging:!1,lngLat:a}}}),this.updateTooltip(e,t),this.calculateRoute())}},{key:"onStyleLoad",value:function(e,t){e.addSource("from_marker",{type:"geojson",data:de}),e.addSource("to_marker",{type:"geojson",data:pe}),e.addLayer({id:"from_marker",type:"circle",source:"from_marker",paint:{"circle-radius":10,"circle-color":"#3887be"}}),e.addLayer({id:"to_marker",type:"circle",source:"to_marker",paint:{"circle-radius":10,"circle-color":"#6b7cff"}});var a=this;e.on("mouseenter","from_marker",function(){e.setPaintProperty("from_marker","circle-color","#3bb2d0"),fe.cursor="move",a.setState({container_style:fe})}),e.on("mouseleave","from_marker",function(){e.setPaintProperty("from_marker","circle-color","#3887be"),fe.cursor="",a.setState({container_style:fe})}),e.on("mousedown","from_marker",function(e){a.state.from_marker.placed&&e.preventDefault(),a.setState(function(e){return{from_marker:{placed:e.from_marker.placed,enabled:e.from_marker.enabled,visible:e.from_marker.visible,dragging:!0,lngLat:e.from_marker.lngLat}}}),fe.cursor="grab",a.setState({container_style:fe})}),e.on("mouseenter","to_marker",function(){e.setPaintProperty("to_marker","circle-color","#3bb2d0"),fe.cursor="move",a.setState({container_style:fe})}),e.on("mouseleave","to_marker",function(){e.setPaintProperty("to_marker","circle-color","#9f7feb"),fe.cursor="",a.setState({container_style:fe})}),e.on("mousedown","to_marker",function(e){a.state.to_marker.placed&&e.preventDefault(),a.setState(function(e){return{to_marker:{placed:e.to_marker.placed,enabled:e.to_marker.enabled,visible:e.to_marker.visible,dragging:!0,lngLat:e.to_marker.lngLat}}}),fe.cursor="grab",a.setState({container_style:fe})})}},{key:"onMouseClick",value:function(e,t){var a=t.lngLat;!this.state.from_marker.enabled||this.state.from_marker.placed||this.state.from_marker.dragging?!this.state.to_marker.enabled||this.state.to_marker.placed||this.state.to_marker.dragging||(console.log("placed to-marker at "+this.state.to_marker.lngLat),this.setState(function(e){return{to_marker:{placed:!0,enabled:!0,visible:!0,dragging:!1,lngLat:a}}}),this.updateTooltip(e,t)):(console.log("placed from-marker at "+this.state.from_marker.lngLat),this.setState(function(e){return{from_marker:{placed:!0,enabled:!0,visible:!0,dragging:!1,lngLat:a}}}),this.state.to_marker.enabled||this.setState({to_marker:{placed:!1,enabled:!0,visible:!0,dragging:!1,lngLat:a}})),this.state.from_marker.enabled&&this.state.to_marker.enabled&&(JSON.stringify([this.state.from_marker.lngLat.lng,this.state.from_marker.lngLat.lat])!==JSON.stringify(this.state.active_route.coordinates[0])||JSON.stringify([this.state.to_marker.lngLat.lng,this.state.to_marker.lngLat.lat])!==JSON.stringify(this.state.active_route.coordinates[this.state.active_route.coordinates.length-1]))&&this.calculateRoute()}},{key:"updateTooltip",value:function(e,t){if(this.state.from_marker.dragging||this.state.to_marker.dragging||!this.state.from_marker.placed&&this.state.from_marker.enabled||!this.state.to_marker.placed&&this.state.to_marker.enabled)e.getCanvas().style.cursor="",this.setState({cursor_location:t.lngLat,map_features:void 0});else{var a=e.queryRenderedFeatures(t.point),n=0,r=[];for(n=0;n<a.length;n++){var o=a[n].layer.id;(o.startsWith("from_marker")||o.startsWith("to_marker")||o.startsWith("road"))&&r.push(a[n])}a.length>0&&(this.setState({cursor_location:t.lngLat,map_features:r}),e.getCanvas().style.cursor="pointer")}}},{key:"onMouseLeave",value:function(e,t){this.setState({show_tooltip:!1}),this.state.from_marker.placed||e.setLayoutProperty("from_marker","visibility","none"),this.state.to_marker.placed||e.setLayoutProperty("to_marker","visibility","none")}},{key:"onMouseMove",value:function(e,t){this.state.show_tooltip||(this.setState({show_tooltip:!0}),e.setLayoutProperty("to_marker","visibility","visible"),e.setLayoutProperty("from_marker","visibility","visible")),this.updateTooltip(e,t),!this.state.from_marker.enabled||this.state.from_marker.placed||this.state.from_marker.dragging?!this.state.to_marker.enabled||this.state.to_marker.placed||this.state.to_marker.dragging||(pe.features[0].geometry.coordinates=[t.lngLat.lng,t.lngLat.lat],e.getSource("to_marker").setData(pe)):(de.features[0].geometry.coordinates=[t.lngLat.lng,t.lngLat.lat],e.getSource("from_marker").setData(de)),this.state.from_marker.dragging?(de.features[0].geometry.coordinates=[t.lngLat.lng,t.lngLat.lat],e.getSource("from_marker").setData(de)):this.state.to_marker.dragging&&(pe.features[0].geometry.coordinates=[t.lngLat.lng,t.lngLat.lat],e.getSource("to_marker").setData(pe))}},{key:"createFromMarker",value:function(){console.log(this.state.from_marker),this.setState(function(e){return{from_marker:{placed:!1,enabled:!0,visible:e.from_marker.visible,dragging:e.from_marker.dragging,lngLat:e.from_marker.lngLat},to_marker:{placed:!1,enabled:!1,visible:!1,dragging:!1,lngLat:[0,0]}}})}},{key:"createToMarker",value:function(){console.log(this.state.to_marker.lngLat),this.setState(function(e){return{to_marker:{placed:!1,enabled:!0,visible:e.to_marker.visible,dragging:e.to_marker.dragging,lngLat:e.to_marker.lngLat}}})}},{key:"render",value:function(){var e=this,t=this.state,a=t.center,n=t.zoom,o=(t.from_marker,t.to_marker,this.state.selected_routes.map(function(t){for(var a=e.state.saved_routes.length,n=0;e.state.saved_routes[n].key!=t&&n<a;)n++;return r.a.createElement(ne.b,{key:e.state.saved_routes[n].key,style:{name:"COOOOL NAME"},type:"line",layout:me,paint:ge},r.a.createElement(ne.a,{coordinates:e.state.saved_routes[n].coordinates}))}));return r.a.createElement("div",{style:{height:"100%",width:"100%"}},r.a.createElement(ie,{style:{height:"117px",width:"100%"},calculating:this.state.calculating,from_marker:this.state.from_marker,to_marker:this.state.to_marker,createFromMarker:this.createFromMarker,createToMarker:this.createToMarker,selectable_routes:this.state.selectable_routes,selected_routes:this.state.selected_routes,handleSelectedRouteAddition:this.handleSelectedRouteAddition,handleSelectedRoutesChange:this.handleSelectedRoutesChange,calculateRoute:this.calculateRoute,saveCurrentRoute:this.saveCurrentRoute,active_route_label_input:this.state.active_route_label_input,updateActiveRouteText:this.updateActiveRouteText,active_route_label_error:this.state.active_route_label_error}),r.a.createElement(O.a,{style:{position:"absolute",top:"117px",bottom:0,width:"67vw",borderRadius:0,padding:0,margin:0,border:"none",overflowY:"Hidden"}},r.a.createElement(j.a,{active:this.state.calculating,inverted:!0},r.a.createElement(x.a,null,"Calculating Route")),r.a.createElement(ue,{style:"mapbox://styles/gugul/cjy77yl1713rg1cn0wiwq2ong/draft",containerStyle:this.state.container_style,center:a,zoom:n,onStyleLoad:this.onStyleLoad,onMouseMove:this.onMouseMove,onMouseUp:this.onMouseUp,onClick:this.onMouseClick,onMouseOut:this.onMouseLeave},r.a.createElement(ne.b,{type:"line",layout:me,paint:he},r.a.createElement(ne.a,{coordinates:this.state.active_route.coordinates})),o,this.state.show_tooltip&&this.state.map_features&&this.state.map_features.length&&r.a.createElement(ne.c,{coordinates:this.state.cursor_location,offset:{"bottom-left":[12,-10],bottom:[0,-10],"bottom-right":[-12,-10]}},r.a.createElement(ce,{features:this.state.map_features})))))}}]),t}(r.a.Component);var ve=function(e){return r.a.createElement("div",{className:"Right-panel"},r.a.createElement(be,{configFile:e.configFile,style:{height:"100%",width:"100%"}}))},ye=a(349),ke=function(){function e(t){Object(p.a)(this,e),this._source=[{type:"file",value:t}],this._engine=ye.newEngine()}return Object(m.a)(e,[{key:"getEntityDescription",value:function(e){var t=this;return new Promise(function(a,n){var r=t._source,o="\n                  SELECT ?p ?o WHERE {\n                    <".concat(e,"> ?p ?o.\n                  }"),l={};t._engine.query(o,{sources:r}).then(function(e){e.bindingsStream.on("data",function(e){l[e.get("?p").value]=e.get("?o").value}).on("end",function(){a(l)})})})}},{key:"getNamedIndividualsForProperty",value:function(e){var t=this;return new Promise(function(a,n){var r=t._source,o="\n                  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\n                  \n                  SELECT ?ni WHERE {\n                    <".concat(e,"> rdfs:range ?range.\n                    ?ni a ?range.\n                  }"),l=[];t._engine.query(o,{sources:r}).then(function(e){e.bindingsStream.on("data",function(e){l.push(e.get("?ni").value)}).on("end",function(){a(l)})})})}}]),e}(),_e=(a(1091),a(475),["access","barrier","bicycle","construction","crossing","cycleway","footway","highway","motor_vehicle","motorcar","oneway_bicycle","oneway","smoothness","surface","tracktype","vehicle"]),Ee={hasAccessRules:{conclusion:"hasAccess",type:"boolean",defaultValue:!1,description:"Determines whether or not a way is accessible."},hasObstacleRules:{conclusion:"isObstacle",type:"boolean",defaultValue:!0,description:"Determines whether or not a node can be traversed."},hasOnewayRules:{conclusion:"isOneway",type:"boolean",defaultValue:!0,description:"Determines whether or not something is a oneway street."},hasPriorityRules:{conclusion:"hasPriority",type:"number",defaultValue:1,description:"Determines an additional multiplier that will be used to demote/promote certain road."},hasSpeedRules:{conclusion:"hasSpeed",type:"number",defaultValue:10,description:"Determines the maximum speed on a street."}};var Ce=function(e){function t(e){var a;return Object(p.a)(this,t),(a=Object(h.a)(this,Object(g.a)(t).call(this,e))).handleFileConfirm=function(e){a.queryOntologyForInformation(e)},a.handleNewRuleSubmit=function(e){e.value="osm:"+e.value,e.key="osm:"+e.key;var t=Object(d.a)({},a.state.configFile),n=!0,r=Ee[e.ruleType].conclusion;if(a.state.configFile[e.ruleType].map(function(a){if(a.match&&a.match.hasPredicate===e.key&&a.match.hasObject===e.value){var o=t[e.ruleType].indexOf(a);return t[e.ruleType][o].concludes[r]=e.conclusion,n=!1,!1}return!0}),n){"number"===Ee[e.ruleType].type&&(e.conclusion=parseInt(e.conclusion));var o={match:{hasPredicate:e.key,hasObject:e.value},concludes:Object(u.a)({},r,e.conclusion),hasOrder:e.order};t[e.ruleType].unshift(o)}a.setState({configFile:t,showModal:!1})},a.handleRuleConclusionChange=function(e,t,n){"number"===Ee[e].type&&(n=parseInt(n));var r=Object(d.a)({},a.state.configFile);r[e][t].concludes[[Ee[e].conclusion]]=n,a.setState({configFile:r})},a.handleRuleDelete=function(e,t){var n=Object(d.a)({},a.state.configFile);t!==n[e].length-1&&(n[e].splice(t,1),a.setState({configFile:n}))},a.handleChangeBasicProperties=function(e){var t=a.state.configFile["rdfs:label"],n=a.state.configFile.hasMaxSpeed,r=a.state.configFile.usePublicTransport;t=e.label?e.label:t,n=e.speed?e.speed:n,r=e.transport?e.transport:r;var o=Object(d.a)({},a.state.configFile);o["rdfs:label"]=t,o.hasMaxSpeed=parseInt(n),o.usePublicTransport=r,a.setState({configFile:o})},a.state={configFile:{},showLandingPage:!0,leftLoaded:!1,ontology:{}},a}return Object(f.a)(t,e),Object(m.a)(t,[{key:"queryOntologyForInformation",value:function(){var e=Object(c.a)(s.a.mark(function e(t){var a,n,r,o,l,i,c,u,d,p,m,h;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a=new ke("http://hdelva.be/tiles/ns/ontology"),n="https://w3id.org/openstreetmap/terms#",r={tags:{},values:{}},_e.map(function(e){return r.tags[e]={values:[],description:{}},r}),o=0,l=Object.keys(r.tags);case 5:if(!(o<l.length)){e.next=44;break}return i=l[o],e.next=9,a.getNamedIndividualsForProperty(n+i);case 9:return e.t0=function(e){return e.slice(n.length)},r.tags[i].values=e.sent.map(e.t0),e.next=13,a.getEntityDescription(n+i);case 13:r.tags[i].description=e.sent,c=!0,u=!1,d=void 0,e.prev=17,p=r.tags[i].values[Symbol.iterator]();case 19:if(c=(m=p.next()).done){e.next=27;break}return h=m.value,e.next=23,a.getEntityDescription(n+h);case 23:r.values[h]=e.sent;case 24:c=!0,e.next=19;break;case 27:e.next=33;break;case 29:e.prev=29,e.t1=e.catch(17),u=!0,d=e.t1;case 33:e.prev=33,e.prev=34,c||null==p.return||p.return();case 36:if(e.prev=36,!u){e.next=39;break}throw d;case 39:return e.finish(36);case 40:return e.finish(33);case 41:o++,e.next=5;break;case 44:this.setState({showLandingPage:!1,ontology:r,configFile:t,leftLoaded:!0});case 45:case"end":return e.stop()}},e,this,[[17,29,33,41],[34,,36,40]])}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(I,{ruleTypes:Ee,onConfirm:this.handleFileConfirm,showModal:this.state.showLandingPage}),r.a.createElement("div",{className:"App-content"},r.a.createElement(te,{ruleTypes:Ee,rulesSelectOptions:this.state.ontology,loaded:this.state.leftLoaded,configFile:this.state.configFile,onNewRuleSubmit:this.handleNewRuleSubmit,onRuleConclusionChange:this.handleRuleConclusionChange,onRuleDelete:this.handleRuleDelete,onChangeBasicProperties:this.handleChangeBasicProperties,className:"Left-panel"}),r.a.createElement(ve,{configFile:this.state.configFile})))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(Ce,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},287:function(e,t,a){},475:function(e,t,a){e.exports=a.p+"static/media/logo.47bb72e5.jpg"},486:function(e,t,a){e.exports=a(1092)},491:function(e,t,a){},694:function(e,t){},695:function(e,t){},714:function(e,t){},716:function(e,t){},801:function(e,t){},804:function(e,t){},813:function(e,t){},814:function(e,t){},989:function(e,t){},990:function(e,t){}},[[486,1,2]]]);
//# sourceMappingURL=main.e3a183bf.chunk.js.map